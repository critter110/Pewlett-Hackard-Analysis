# Pewlett-Hackard-Analysis
## Challenge
The PH company is preparing to deal with the consequences of a mass retirement of employees. In order to help get a better picture of the actual number of people retiring and from which departments they will be retiring from, our manager has asked us to construct several tables in postgreSQL. Our first task was to create a table that shows all the employees that are nearing retirement (born between Jan. 1st 1952, and Dec. 31st 1955), their employee number, first name, last name, their title, salary, and the date they were hired. We did this by joining our employee info table [emp_info.csv](https://github.com/critter110/Pewlett-Hackard-Analysis/blob/master/emp_info.csv) with our original [titles.csv](https://github.com/critter110/Pewlett-Hackard-Analysis/blob/master/Data/titles.csv) table using an inner join and selecting the stated info above. After doing this however, we noticed that multiple employees were listed more than once. This occured if the employee held more than one title while working at PH. In order to fix this, we partitioned this newly made table by employee number, and in the case of duplicates, only chose the row with the most recent from_date, or the date they started that title. Finally, we orded this table by job title, so all the employees with the same title are grouped together. The final product can be found here: '[challenge_ret_by_title_no_dups.csv](https://github.com/critter110/Pewlett-Hackard-Analysis/blob/master/challenge_ret_by_title_no_duplicates.csv)'. Using this table, our manager can get a picture of which emplyees are near retirement and which title they have. 


The second task we were given was to construct a table that shows the number of employees near retirement from each title. We did this by selecting a count() of employee numbers and title from the '[challenge_retirees_grouped_by_title_no_dup](https://github.com/critter110/Pewlett-Hackard-Analysis/blob/master/challenge_ret_by_title_no_duplicates.csv)' table, and used groupby() title. The table can be seen in the file '[challenge_counts_of_retirees_by_title.csv](https://github.com/critter110/Pewlett-Hackard-Analysis/blob/master/challenge_counts_of_retirees_by_title.csv)'. This showed us that the majority of employees near retirement are senior engineers and senior staff.  

Our final task was to create a table that showed all of the employees, their employee number, title, and the dates they were hired. In order to accomplosh this, we joined our '[employees.csv](https://github.com/critter110/Pewlett-Hackard-Analysis/blob/master/Data/employees.csv)' table with the '[titles](https://github.com/critter110/Pewlett-Hackard-Analysis/blob/master/Data/titles.csv)' table with the constraint that the employees birthdays be between Jan. 1st 1965 and Dec. 31st 1965. However we encountered the same issue with duplicate employees in the case that they held multiple titles at the company. To fix this we used the same partition method from earlier and in the case of duplicates, only kept the row with the most recent from_date. The file can be seen in [challenge_mentor_eligibility.csv](https://github.com/critter110/Pewlett-Hackard-Analysis/blob/master/challenge_mentor_eligibility.csv)
